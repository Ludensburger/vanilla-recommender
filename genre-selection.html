<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Genre Selection</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <form id="genreForm">
      <table class="genre-table">
        <tr>
          <th colspan="4">Select Music Genres</th>
        </tr>
        <tr>
          <td>
            <input type="checkbox" name="genres" value="acoustic" /> Acoustic
          </td>
          <td>
            <input type="checkbox" name="genres" value="alt-rock" /> Alt Rock
          </td>
          <td>
            <input type="checkbox" name="genres" value="alternative" />
            Alternative
          </td>
          <td>
            <input type="checkbox" name="genres" value="ambient" /> Ambient
          </td>
        </tr>
        <tr>
          <td>
            <input type="checkbox" name="genres" value="black-metal" /> Black
            Metal
          </td>
          <td><input type="checkbox" name="genres" value="blues" /> Blues</td>
          <td>
            <input type="checkbox" name="genres" value="bossanova" /> Bossa Nova
          </td>
          <td>
            <input type="checkbox" name="genres" value="classical" />
            Classical
          </td>
        </tr>
        <tr>
          <td>
            <input type="checkbox" name="genres" value="country" /> Country
          </td>
          <td><input type="checkbox" name="genres" value="dance" /> Dance</td>
          <td>
            <input type="checkbox" name="genres" value="death-metal" /> Death
            Metal
          </td>
          <td>
            <input type="checkbox" name="genres" value="deep-house" /> Deep
            House
          </td>
        </tr>
        <tr>
          <td><input type="checkbox" name="genres" value="disco" /> Disco</td>
          <td>
            <input type="checkbox" name="genres" value="dubstep" /> Dubstep
          </td>
          <td><input type="checkbox" name="genres" value="edm" /> EDM</td>
          <td>
            <input type="checkbox" name="genres" value="electro" /> Electro
          </td>
        </tr>
        <tr>
          <td>
            <input type="checkbox" name="genres" value="electronic" />
            Electronic
          </td>
          <td><input type="checkbox" name="genres" value="emo" /> Emo</td>
          <td><input type="checkbox" name="genres" value="folk" /> Folk</td>
          <td><input type="checkbox" name="genres" value="funk" /> Funk</td>
        </tr>
        <tr>
          <td><input type="checkbox" name="genres" value="goth" /> Goth</td>
          <td>
            <input type="checkbox" name="genres" value="grindcore" />
            Grindcore
          </td>
          <td><input type="checkbox" name="genres" value="groove" /> Groove</td>
          <td><input type="checkbox" name="genres" value="grunge" /> Grunge</td>
        </tr>
        <tr>
          <td><input type="checkbox" name="genres" value="guitar" /> Guitar</td>
          <td>
            <input type="checkbox" name="genres" value="hard-rock" /> Hard Rock
          </td>
          <td>
            <input type="checkbox" name="genres" value="hardcore" /> Hardcore
          </td>
          <td>
            <input type="checkbox" name="genres" value="heavy-metal" /> Heavy
            Metal
          </td>
        </tr>
        <tr>
          <td>
            <input type="checkbox" name="genres" value="hip-hop" /> Hip Hop
          </td>
          <td><input type="checkbox" name="genres" value="house" /> House</td>
          <td><input type="checkbox" name="genres" value="indie" /> Indie</td>
          <td>
            <input type="checkbox" name="genres" value="indie-pop" /> Indie Pop
          </td>
        </tr>
        <tr>
          <td><input type="checkbox" name="genres" value="j-pop" /> J-Pop</td>
          <td><input type="checkbox" name="genres" value="j-rock" /> J-Rock</td>
          <td><input type="checkbox" name="genres" value="jazz" /> Jazz</td>
          <td><input type="checkbox" name="genres" value="k-pop" /> K-Pop</td>
        </tr>
        <tr>
          <td><input type="checkbox" name="genres" value="metal" /> Metal</td>
          <td>
            <input type="checkbox" name="genres" value="metalcore" />
            Metalcore
          </td>
          <td><input type="checkbox" name="genres" value="movies" /> Movies</td>
          <td>
            <input type="checkbox" name="genres" value="philippines-opm" />
            Philippines OPM
          </td>
        </tr>
        <tr>
          <td><input type="checkbox" name="genres" value="piano" /> Piano</td>
          <td><input type="checkbox" name="genres" value="pop" /> Pop</td>
          <td>
            <input type="checkbox" name="genres" value="progressive-house" />
            Progressive House
          </td>
          <td><input type="checkbox" name="genres" value="punk" /> Punk</td>
        </tr>
        <tr>
          <td>
            <input type="checkbox" name="genres" value="punk-rock" /> Punk Rock
          </td>
          <td><input type="checkbox" name="genres" value="r-n-b" /> R&B</td>
          <td><input type="checkbox" name="genres" value="reggae" /> Reggae</td>
          <td>
            <input type="checkbox" name="genres" value="road-trip" /> Road Trip
          </td>
        </tr>
      </table>

      <div class="genre-prompt-container">
        <button type="submit">Submit</button>
        <button type="reset">Clear</button>
        <p class="selection-counter">0</p>
      </div>

      <div class="prompt">
        <p></p>
      </div>
    </form>
  </body>

  <script>
    function decimalToRoman(num) {
      const romanNumerals = [
        { value: 1000, numeral: "M" },
        { value: 900, numeral: "CM" },
        { value: 500, numeral: "D" },
        { value: 400, numeral: "CD" },
        { value: 100, numeral: "C" },
        { value: 90, numeral: "XC" },
        { value: 50, numeral: "L" },
        { value: 40, numeral: "XL" },
        { value: 10, numeral: "X" },
        { value: 9, numeral: "IX" },
        { value: 5, numeral: "V" },
        { value: 4, numeral: "IV" },
        { value: 1, numeral: "I" },
      ];

      let result = "";

      for (const { value, numeral } of romanNumerals) {
        while (num >= value) {
          result += numeral;
          num -= value;
        }
      }

      return result;
    }

    const checkboxes = document.querySelectorAll('input[name="genres"]');
    const submitButton = document.querySelector("button[type='submit']");
    const clearButton = document.querySelector("button[type='reset']");
    const counter = document.querySelector(".selection-counter");
    counter.style.fontWeight = "bold";
    counter.style.fontSize = "1.5rem";

    submitButton.style.height = "2rem";
    submitButton.style.width = "5rem";
    submitButton.style.backgroundColor = "green";
    submitButton.style.color = "white";
    submitButton.style.border = "none";
    submitButton.style.borderRadius = "5px";

    clearButton.style.height = "2rem";
    clearButton.style.width = "5rem";
    clearButton.style.backgroundColor = "red";
    clearButton.style.color = "white";
    clearButton.style.border = "none";
    clearButton.style.borderRadius = "5px";

    checkboxes.forEach((checkbox) => {
      checkbox.addEventListener("change", () => {
        const selectedCount = document.querySelectorAll(
          'input[name="genres"]:checked'
        ).length;

        counter.textContent = decimalToRoman(selectedCount);

        if (selectedCount < 5) {
          counter.style.color = "red";
        } else if (selectedCount == 5) {
          counter.style.color = "green";
        } else {
          counter.style.color = "red";
        }
      });
    });
  </script>

  <script>
    const form = document.querySelector("#genreForm");

    form.addEventListener("submit", (e) => {
      e.preventDefault();

      const genres = document.querySelectorAll('input[name="genres"]:checked');
      const genreList = [];

      genres.forEach((genre) => {
        genreList.push(genre.value);
      });

      const prompt = document.querySelector(".prompt p");

      if (genreList.length != 5) {
        console.log("Please select at most five genres.");
        prompt.textContent = "Please select at most five (5) genres.";
        prompt.style.color = "red";

        return;
      } else {
        console.log("Genres selected: " + genreList.join(", "));
        // remove prompt
        prompt.textContent = "";
        console.log(genreList);

        // Send data to recommender-system.js
        const event = new CustomEvent("genresSelected", { detail: genreList });
        window.dispatchEvent(event);
      }
    });
  </script>

  <script src="recommender-system.js"></script>
</html>
